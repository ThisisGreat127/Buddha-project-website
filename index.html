<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <title>ธรรมะจรรโลงใจ</title>
    <style>
        body {
            background-color: #fdf5e6;
            font-family: 'Sarabun', sans-serif;
            margin: 0;
            overflow-x: hidden;
        }
        h1.box {
            color: white;
            background: linear-gradient(135deg, #2c3e50, #000000);
            padding: 20px;
            margin: 0;
            text-align: center;
        }
        /* Responsive Tree Container */
        .tree-container {
            position: relative;
            width: 100%;
            max-width: 900px;
            margin: 20px auto;
            line-height: 0;
        }
        .img-16-9 {
            width: 100%;
            height: auto;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        /* Leaf Styling */
        .leaf-wrapper {
            position: absolute;
            z-index: 100;
            cursor: pointer;
            width: 8%; /* ปรับขนาดตามหน้าจอ */
        }
        .leaf-img {
            width: 100%;
            height: auto;
            animation: sway 3s infinite ease-in-out;
            transform-origin: top center;
        }
        @keyframes sway {
            0%, 100% { transform: rotate(-8deg); }
            50% { transform: rotate(8deg); }
        }
        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 2000;
            left: 0; top: 0; width: 100%; height: 100%;
            background-color: rgba(0,0,0,0.6);
            backdrop-filter: blur(5px);
        }
        .modal-content {
            background: white;
            margin: 15% auto;
            padding: 30px;
            width: 90%;
            max-width: 500px;
            border-radius: 20px;
            text-align: center;
        }
        /* Table Style */
        .info-table {
            max-width: 900px;
            margin: 20px auto;
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }
        .falling-leaf {
            position: fixed;
            top: -50px;
            z-index: 999;
            pointer-events: none;
            background-image: url('leaf.png');
            background-size: contain;
            background-repeat: no-repeat;
            animation: fall linear forwards;
        }
        @keyframes fall { to { transform: translateY(110vh) rotate(360deg); } }
    </style>
</head>
<body>

<header>
    <h1 class="box">ธรรมะจรรโลงใจ</h1>
    <p class="text-center mt-3">คลิกที่ใบโพธิ์เพื่อฟังธรรม (มีเพลงประกอบ)</p>
</header>

<div class="tree-container">
    <img src="buddha-bg2.png" class="img-16-9" alt="Background">

    <?php
    // ข้อมูลพิกัดและธรรมะ (PHP จัดการ Asset และ Data)
    $dhamma_list = [
        ["top" => "15%", "left" => "20%", "text" => "ข้อ 1: ทาน - การให้และแบ่งปัน"],
        ["top" => "10%", "left" => "40%", "text" => "ข้อ 2: ศีล - ความประพฤติดีงาม"],
        ["top" => "15%", "left" => "60%", "text" => "ข้อ 3: บริจาค - การเสียสละความสุขส่วนตน"],
        ["top" => "30%", "left" => "15%", "text" => "ข้อ 4: อาชชวะ - ความซื่อตรง"],
        ["top" => "35%", "left" => "75%", "text" => "ข้อ 5: มัททวะ - ความอ่อนโยน"],
        ["top" => "50%", "left" => "30%", "text" => "ข้อ 6: ตบะ - ความเพียรเผากิเลส"],
        ["top" => "45%", "left" => "55%", "text" => "ข้อ 7: อักโกธะ - ความไม่โกรธ"],
        ["top" => "25%", "left" => "80%", "text" => "ข้อ 8: อวิหิงสา - ความไม่เบียดเบียน"],
        ["top" => "60%", "left" => "10%", "text" => "ข้อ 9: ขันติ - ความอดทน"],
        ["top" => "65%", "left" => "85%", "text" => "ข้อ 10: อวิโรธนะ - ความตั้งมั่นในธรรม"]
    ];

    foreach ($dhamma_list as $item) {
        echo '<div class="leaf-wrapper" style="top: '.$item['top'].'; left: '.$item['left'].';" onclick="openLeaf(\''.$item['text'].'\')">
                <img src="leaf.png" class="leaf-img">
              </div>';
    }
    ?>
</div>

<div class="info-table container">
    <h4 class="mb-3">สรุปหลักธรรม 10 ประการ</h4>
    <table class="table table-hover">
        <thead class="table-dark">
            <tr><th>ลำดับ</th><th>หลักธรรม</th></tr>
        </thead>
        <tbody>
            <?php foreach ($dhamma_list as $index => $item) {
                echo "<tr><td>".($index+1)."</td><td>".$item['text']."</td></tr>";
            } ?>
        </tbody>
    </table>
</div>

<div id="modal" class="modal">
    <div class="modal-content">
        <h3>คติธรรม</h3><hr>
        <p id="dhamma-text"></p>
        <button class="btn btn-dark mt-3" onclick="closeLeaf()">ปิด</button>
    </div>
</div>

<audio id="bgMusic" loop>
    <source src="Ylang Ylang.mp3.mp3" type="audio/mpeg">
</audio>

<script>
    const music = document.getElementById('bgMusic');

    function openLeaf(text) {
        document.getElementById('dhamma-text').innerText = text;
        document.getElementById('modal').style.display = "block";
        // เล่นเพลงเมื่อมีการคลิก (แก้ปัญหา Browser บล็อก Auto-play)
        music.play().catch(e => console.log("Music play blocked"));
    }

    function closeLeaf() {
        document.getElementById('modal').style.display = "none";
    }

    // ระบบใบไม้ร่วง
    function createFallingLeaf() {
        const leaf = document.createElement('div');
        leaf.classList.add('falling-leaf');
        leaf.style.left = Math.random() * 100 + "vw";
        const duration = Math.random() * 5 + 5;
        leaf.style.animationDuration = duration + "s";
        leaf.style.width = Math.random() * 20 + 20 + "px";
        leaf.style.height = leaf.style.width;
        document.body.appendChild(leaf);
        setTimeout(() => { leaf.remove(); }, duration * 1000);
    }
    setInterval(createFallingLeaf, 700);

    // ปิด Modal เมื่อคลิกข้างนอก
    window.onclick = function(e) {
        if (e.target == document.getElementById('modal')) closeLeaf();
    }
</script>

</body>
</html>
